#!/usr/bin/env bash
# shellcheck source=shell-and-scripting-helpers/.qfuncs.sh
source "$(dirname "$0")"/shell-and-scripting-helpers/.qfuncs.sh

set -e

#!/usr/bin/env bash
# Install/update selected Piper voices with git sparse checkout.
# Destination: ~/.local/share/piper/voices

set -euo pipefail

dest=~/.local/share/piper/voices
repo="https://huggingface.co/rhasspy/piper-voices"

voices=(
  "en/en_GB/cori/high"                       # UK female (high)
  "en/en_GB/alan/medium"                     # UK male (medium)
  "en/en_GB/northern_english_male/medium"    # UK male regional (medium)
#   "en/en_GB/southern_english_female/low"
#   "en/en_GB/alba/medium"
#   "en/en_GB/aru/medium"
#   "en/en_GB/jenny_dioco/medium"
#   "en/en_GB/semaine/medium"
#   "en/en_GB/vctk/medium"
  "en/en_US/ryan/high"                       # US male (high)
  "en/en_US/amy/medium"                      # US female (medium)
  "en/en_US/lessac/high"                     # US female (high)
#   "en/en_US/lessac/medium"
#   "en/en_US/joe/medium"
#   "en/en_US/john/medium"
#   "en/en_US/hfc_male/medium"
#   "en/en_US/hfc_female/medium"
#   "en/en_US/l2arctic/medium"
#   "en/en_US/arctic/medium"
#   "en/en_US/bryce/medium"
#   "en/en_US/sam/medium"
  # "nl/nl_BE/nathalie/medium"                 # BE Dutch female (medium)
  # "nl/nl_BE/nathalie/medium"                 # BE Dutch female (medium, English-capable)
)

mkdir -p "$dest"

if [ ! -d "$dest/.git" ]; then
  info "Cloning Piper voices repo into $dest ..."
  git clone --depth=1 --filter=blob:none --sparse "$repo" "$dest"
  cd "$dest"
  git sparse-checkout set --no-cone "${voices[@]}"
else
  info "Updating existing voices repo in $dest ..."
  cd "$dest"
  git pull --depth=1
  git sparse-checkout set --no-cone "${voices[@]}"
fi

echo "Voices installed under: $dest"
